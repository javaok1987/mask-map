{"version":3,"sources":["components/map.js","components/drugstore-card.js","components/city-select.js","App.js","serviceWorker.js","index.js"],"names":["L","window","turf","getColor","d","onEachFeature","feature","layer","popupContent","properties","name","mask_adult","mask_child","bindPopup","Map","props","state","myPlace","markerPool","maskMap","countryLayer","countryName","this","markerClusterGroup","zoomToBoundsOnClick","removeOutsideVisibleBounds","center","latitude","longitude","map","zoom","layers","tileLayer","attribution","maxZoom","id","accessToken","marker","addTo","locate","setView","on","e","setState","latlng","setLatLng","openPopup","legend","control","position","onAdd","div","DomUtil","create","grades","labels","i","length","push","innerHTML","join","getLegendControl","customAction","Toolbar2","Action","extend","options","toolbarIcon","html","tooltip","addHooks","flyTo","Control","actions","clearLayers","focus","_focus","LatLng","lat","lng","country","centerOfMass","centerLatLng","geometry","coordinates","geoJson","addData","markersData","ptsWithin","pointsWithinPolygon","geoJSON","style","color","pointToLayer","maskCount","circleMarker","radius","weight","opacity","fillOpacity","fillColor","getStyle","addLayer","React","Component","DrugdrugstoreCard","handleClick","drugstore","onClickDrugstore","lat1","lng1","lat2","lng2","radLat1","Math","PI","radLat2","a","b","s","asin","sqrt","pow","sin","cos","round","mask","total","percent","currentLocation","city","district","className","features","address","substring","Card","key","Content","onClick","Header","Meta","phone","Description","href","target","rel","custom_note","Message","size","Icon","extra","Progress","getPercent","indicating","SelectCountry","handleCity","value","onSelectCity","currentCity","CITY_AREA","find","item","index","array","districtOptions","districts","text","_district","onSelectDistrict","handleDistrict","cityOptions","Dropdown","button","floating","labeled","scrolling","icon","onChange","App","twCountyGJson","filter","county","handleClickDrugstore","viewport","drugstoreGJson","visible","showChild","fetch","then","response","json","geojson","screen","availWidth","document","body","classList","add","catch","err","console","log","Button","compact","labelPosition","toggleSidebar","Boolean","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.78a9ebc8.chunk.js","sourcesContent":["import React from 'react';\n\n// Import CSS from Leaflet and plugins.\nimport 'leaflet.markercluster/dist/MarkerCluster.css';\nimport 'leaflet.markercluster/dist/MarkerCluster.Default.css';\nimport 'leaflet-toolbar/dist/leaflet.toolbar.css';\n\n// Import JS from Leaflet and plugins.\nimport 'leaflet.markercluster';\nimport 'leaflet-toolbar';\n\nimport '../styles/map.scss';\n\nconst L = window.L;\nconst turf = window.turf;\n\nconst getColor = d => {\n  return d > 480 ? '#7cafc2' : d > 360 ? '#86c1b9' : d > 240 ? '#a1b56c' : d > 120 ? '#f7ca88' : d > 0 ? '#dc9656' : 'rgba(236,222,239,.9)';\n};\n\nconst getStyle = maskCount => {\n  return {\n    radius: 10,\n    weight: 1,\n    opacity: 1,\n    fillOpacity: 1,\n    fillColor: getColor(maskCount)\n  };\n};\n\nconst getLegendControl = () => {\n  //Custom Legend Control.\n  const legend = L.control({ position: 'bottomright' });\n  legend.onAdd = () => {\n    const div = L.DomUtil.create('div', 'legend-panel');\n    const grades = [0, 120, 240, 360, 480];\n    const labels = [];\n\n    for (let i = 0; i < grades.length; i++) {\n      labels.push(`\n        <div class=\"legend-item\">\n          <i style=\"background:${getColor(grades[i] + 1)}\"></i>${grades[i]}↑\n        </div>\n      `);\n    }\n    div.innerHTML = labels.join('');\n    return div;\n  };\n  return legend;\n};\n\nconst onEachFeature = (feature, layer) => {\n  const popupContent = `\n      <div class=\"info-window\">\n        <h3>${layer.feature.properties.name}</h3>\n        <p>成人口罩\b：${feature.properties.mask_adult} 個</p>\n        <p>兒童口罩：${feature.properties.mask_child} 個</p>\n      </div>\n    `;\n  layer.bindPopup(popupContent);\n};\n\nexport default class Map extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      myPlace: null,\n      markerPool: null,\n      maskMap: null,\n      // mapLayer:null,\n      countryLayer: null,\n      countryName: ''\n    };\n  }\n\n  componentDidMount() {\n    this.markerPool = L.markerClusterGroup({\n      zoomToBoundsOnClick: true,\n      removeOutsideVisibleBounds: true\n    });\n\n    const center = [this.props.latitude, this.props.longitude];\n    // Create map.\n    this.maskMap = L.map('map-canvas', {\n      center,\n      zoom: 12,\n      layers: [\n        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {\n          attribution:\n            'Map data &copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n          maxZoom: 20,\n          id: 'mapbox/streets-v11',\n          accessToken: 'pk.eyJ1IjoiaWFubGlhbzE5ODciLCJhIjoiY2s2OHFmMzQ0MDV5MjN1bjlmMzF2a3htZyJ9.n70D4lI2aqZ1dj-EGCuqJw'\n        })\n      ]\n    });\n\n    this.marker = L.marker(center).addTo(this.maskMap);\n\n    // Geolocation.\n    this.maskMap.locate({ setView: true, maxZoom: 11 });\n    this.maskMap.on('locationfound', e => {\n      this.setState({ myPlace: e.latlng });\n      // Add marker.\n      this.marker\n        .setLatLng(this.state.myPlace)\n        .bindPopup('You are here!')\n        .openPopup();\n    });\n\n    const legend = getLegendControl();\n    legend.addTo(this.maskMap);\n\n    // ToolBar.\n    const customAction = L.Toolbar2.Action.extend({\n      options: {\n        toolbarIcon: {\n          html: '<div><i aria-hidden=\"true\" class=\"crosshairs small icon\"></i></div>',\n          tooltip: 'Go to the Eiffel Tower'\n        }\n      },\n      addHooks: () => {\n        if (this.state.myPlace) {\n          this.marker\n            .setLatLng(this.state.myPlace)\n            .bindPopup('You are here!')\n            .openPopup();\n          this.maskMap.flyTo(this.state.myPlace, 17);\n        }\n      }\n    });\n    new L.Toolbar2.Control({\n      actions: [customAction]\n    }).addTo(this.maskMap);\n  }\n\n  componentDidUpdate() {\n    this.markerPool.clearLayers();\n\n    if (this.props.focus) {\n      const _focus = new L.LatLng(this.props.focus[1], this.props.focus[0]);\n      this.marker\n        .setLatLng(_focus)\n        .bindPopup(\n          this.state.myPlace\n            ? `<a href=\"https://www.google.com.tw/maps/dir/${this.state.myPlace.lat},${this.state.myPlace.lng}/${this.props.focus[1]},${this.props.focus[0]}\" target=\"_blank\" rel=\"noopener noreferrer\">前往藥局</a>`\n            : `<a href=https://www.google.com.tw/maps/place/${this.props.focus[1]},${this.props.focus[0]} target=\"_blank\" rel=\"noopener noreferrer\">前往藥局</a>`\n        )\n        .openPopup();\n      this.maskMap.flyTo(_focus, 17);\n    }\n\n    if (this.props.layer && this.props.layer.length === 1) {\n      const country = this.props.layer[0];\n\n      // 相同縣市不清除.\n      if (country.properties.name !== this.countryName) {\n        if (this.countryLayer) this.countryLayer.clearLayers();\n\n        const center = turf.centerOfMass(country);\n        const centerLatLng = new L.LatLng(center.geometry.coordinates[1], center.geometry.coordinates[0]);\n\n        this.countryLayer = L.geoJson(null)\n          .addData(this.props.layer)\n          .addTo(this.maskMap);\n\n        this.countryName = country.properties.name;\n\n        this.marker\n          .setLatLng(centerLatLng)\n          .bindPopup(this.countryName)\n          .openPopup();\n\n        this.maskMap.flyTo(centerLatLng, 10);\n      }\n\n      if (!this.props.markersData) return false;\n\n      const ptsWithin = turf.pointsWithinPolygon(this.props.markersData, this.props.layer[0]);\n      if (ptsWithin) {\n        L.geoJSON(ptsWithin, {\n          style: function(feature) {\n            return { color: feature.properties.color };\n          },\n          onEachFeature,\n          pointToLayer: (feature, latlng) => {\n            const maskCount = feature.properties.mask_adult;\n            const marker = L.circleMarker(latlng, getStyle(maskCount));\n            this.markerPool.addLayer(marker);\n            return marker;\n          }\n        });\n        this.maskMap.addLayer(this.markerPool);\n      }\n    }\n  }\n\n  render() {\n    return <div id=\"map-canvas\"></div>;\n  }\n}\n","import React from 'react';\nimport { Card, Progress, Message, Icon } from 'semantic-ui-react';\n\nexport default class DrugdrugstoreCard extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  /**\n   * 計算兩個坐標點之間的距離\n   * @param {*} lat1\n   * @param {*} lng1\n   * @param {*} lat2\n   * @param {*} lng2\n   */\n  getDistance(lat1, lng1, lat2, lng2) {\n    const radLat1 = (lat1 * Math.PI) / 180.0;\n    const radLat2 = (lat2 * Math.PI) / 180.0;\n    const a = radLat1 - radLat2;\n    const b = (lng1 * Math.PI) / 180.0 - (lng2 * Math.PI) / 180.0;\n    let s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(a / 2), 2) + Math.cos(radLat1) * Math.cos(radLat2) * Math.pow(Math.sin(b / 2), 2)));\n    s = s * 6378.137; // EARTH_RADIUS;\n    s = Math.round(s * 10000) / 10000;\n    return s;\n  }\n\n  getPercent(mask, total) {\n    let percent = mask / total;\n    return percent > 1 ? 100 : percent * 100;\n  }\n\n  handleClick = drugstore => {\n    this.props.onClickDrugstore(drugstore);\n  };\n\n  render() {\n    const currentLocation = `${this.props.city}${this.props.district}`;\n\n    return (\n      <div className=\"floating-panel__list\">\n        {this.props.markersData &&\n          this.props.markersData.features.map(drugstore => {\n            return drugstore.properties.address.substring(0, currentLocation.length) === currentLocation ? ( // 縣市區域過濾.\n              <Card key={drugstore.properties.id} className={drugstore.properties.mask_adult === 0 ? 'is-disable' : ''}>\n                <Card.Content onClick={() => this.handleClick(drugstore.geometry)}>\n                  <Card.Header>{drugstore.properties.name}</Card.Header>\n                  <Card.Meta>{drugstore.properties.phone}</Card.Meta>\n                  <Card.Description>\n                    {drugstore.properties.address}\n                    <a href={`https://www.google.com.tw/maps/place/${drugstore.properties.address}`} target=\"_blank\" rel=\"noopener noreferrer\">\n                      {' '}\n                      MAP\n                    </a>\n                    <br />\n                    {drugstore.properties.custom_note === '' ? null : (\n                      <Message size=\"tiny\">\n                        <Icon name=\"bullhorn\" />\n                        {drugstore.properties.custom_note}\n                      </Message>\n                    )}\n                  </Card.Description>\n                </Card.Content>\n                <Card.Content extra>\n                  <Progress percent={this.getPercent(drugstore.properties.mask_adult, 600)} indicating>\n                    成人:{drugstore.properties.mask_adult}\n                  </Progress>\n                  <Progress percent={this.getPercent(drugstore.properties.mask_child, 200)} indicating>\n                    兒童:{drugstore.properties.mask_child}\n                  </Progress>\n                </Card.Content>\n              </Card>\n            ) : null;\n          })}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { Dropdown } from 'semantic-ui-react';\n\nimport CITY_AREA from '../data/city-area.json';\n\nexport default class SelectCountry extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cityOptions: CITY_AREA.map(item => ({\n        key: item.id,\n        text: item.name,\n        value: item.name\n      })),\n      districtOptions: [\n        { key: 15, text: '板橋區', value: '板橋區' },\n        { key: 28, text: '土城區', value: '土城區' },\n        { key: 23, text: '新店區', value: '新店區' },\n        { key: 26, text: '永和區', value: '永和區' },\n        { key: 27, text: '中和區', value: '中和區' }\n      ],\n      city: '新北市',\n      district: '土城區'\n    };\n  }\n\n  handleCity = (e, { value }) => {\n    this.props.onSelectCity(value);\n\n    const currentCity = CITY_AREA.find(function(item, index, array) {\n      return item.name === value;\n    });\n    this.setState({\n      city: value,\n      districtOptions: currentCity.districts.map(item => ({\n        key: item.id,\n        text: item.name,\n        value: item.name\n      }))\n    });\n\n    if (currentCity.districts && currentCity.districts.length > 1) {\n      const _district = currentCity.districts[0].name;\n      this.setState({\n        district: _district\n      });\n      this.props.onSelectDistrict(_district);\n    }\n  };\n\n  handleDistrict = (e, { value }) => {\n    this.setState({\n      district: value\n    });\n    this.props.onSelectDistrict(value);\n  };\n\n  render() {\n    const { cityOptions, districtOptions, city, district } = this.state;\n\n    return (\n      <div>\n        <Dropdown\n          button\n          className=\"icon teal\"\n          floating\n          labeled\n          scrolling\n          icon=\"filter\"\n          options={cityOptions}\n          onChange={this.handleCity}\n          text={city}\n        />\n        <Dropdown\n          button\n          className=\"icon teal\"\n          floating\n          labeled\n          scrolling\n          icon=\"filter\"\n          options={districtOptions}\n          onChange={this.handleDistrict}\n          text={district}\n        />\n      </div>\n    );\n  }\n}\n","import React from 'react';\n\nimport MaskMap from './components/map';\nimport DrugstoreCard from './components/drugstore-card';\nimport CitySelect from './components/city-select';\n\nimport { Button, Icon } from 'semantic-ui-react';\n\nimport 'normalize.css';\nimport './App.css';\n\nexport default class App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      viewport: {\n        latitude: 25.030313,\n        longitude: 121.54924,\n        zoom: 16\n      },\n      drugstoreGJson: null,\n      twCountyGJson: null,\n      layer: null,\n      focus: null,\n      visible: true,\n      showChild: false,\n      city: '新北市',\n      district: '土城區'\n    };\n  }\n\n  componentDidMount() {\n    fetch('https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json')\n      .then(response => response.json())\n      .then(geojson => {\n        this.setState({ drugstoreGJson: geojson });\n        if (('availWidth', window.screen.availWidth <= 768)) this.setState({ visible: false });\n        document.body.classList.add('dom-ready');\n      })\n      .catch(err => {\n        console.log('錯誤:', err);\n      });\n\n    fetch('https://raw.githubusercontent.com/javaok1987/mask-map/master/src/data/tw-county.geojson')\n      .then(response => response.json())\n      .then(geojson => {\n        this.setState({ twCountyGJson: geojson });\n        this.setState({\n          layer: this.state.twCountyGJson['features'].filter(county => {\n            return county.properties.name === this.state.city;\n          })\n        });\n      })\n      .catch(err => {\n        console.log('錯誤:', err);\n      });\n  }\n\n  toggleSidebar(visible) {\n    this.setState({ visible: !visible });\n  }\n\n  handleCity = city => {\n    this.setState({\n      city,\n      focus: null,\n      layer: this.state.twCountyGJson['features'].filter(county => {\n        return county.properties.name === city;\n      })\n    });\n  };\n\n  handleDistrict = district => {\n    this.setState({ focus: null, district });\n  };\n\n  handleClickDrugstore = drugstore => {\n    this.setState({\n      focus: drugstore.coordinates\n    });\n  };\n\n  render() {\n    const { viewport, drugstoreGJson, city, district, focus, layer } = this.state;\n\n    return (\n      <div className=\"app\">\n        <MaskMap {...viewport} markersData={drugstoreGJson} layer={layer} focus={focus}></MaskMap>\n        <div className={this.state.visible ? 'floating-panel is-visible' : 'floating-panel'}>\n          <div className=\"floating-panel__header\">\n            <h3>口罩地圖 MASK MAP</h3>\n            <CitySelect onSelectCity={this.handleCity} onSelectDistrict={this.handleDistrict}></CitySelect>\n          </div>\n          <DrugstoreCard markersData={drugstoreGJson} city={city} district={district} onClickDrugstore={this.handleClickDrugstore}></DrugstoreCard>\n          <Button icon compact color=\"teal\" labelPosition=\"right\" className=\"floating-panel__close\" onClick={() => this.toggleSidebar(this.state.visible)}>\n            關閉\n            <Icon name={this.state.visible ? 'angle double left' : 'angle double right'} />\n          </Button>\n        </div>\n      </div>\n    );\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}